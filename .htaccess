# Enable mod_rewrite engine
RewriteEngine On

# Prevent direct access to the home page ("/") - COMMENT OUT or REMOVE
# RewriteCond %{REQUEST_URI} ^/$
# RewriteRule ^$ - [F,L]

# Do not apply rewrites to existing directories or files
RewriteCond %{REQUEST_FILENAME} !-d               # Don't rewrite directories
RewriteCond %{REQUEST_FILENAME} !-f               # Don't rewrite existing files (e.g., images, CSS)

# General rewrite rules for URLs that need to be processed as PHP (without .php extension)
RewriteRule ^(admin/([a-zA-Z0-9_-]+))$ admin/$2.php [NC,L]
RewriteRule ^(index|about|contact|register_instructor|step_register|login|instructor-reg|student-reg|student-signup|step-123|exam|finished|home)$ $1.php [NC,L]

# Remove .php extension for access-control.php
RewriteCond %{REQUEST_FILENAME} !-f               # Ensure it's not a real file
RewriteCond %{REQUEST_FILENAME} !-d               # Ensure it's not a real directory
RewriteRule ^admin/access-control$ admin/access-control.php [NC,L]

# Redirect .php URLs to clean URLs (for SEO purposes), EXCEPT for "student-signup.php"
RewriteCond %{THE_REQUEST} \s/([^/]+)\.php [NC]
RewriteCond %{REQUEST_URI} !^/student-signup.php$  # Exclude student-signup.php from redirection
RewriteRule ^([^/]+)\.php$ /$1 [R=301,L]    # Redirect .php URLs to clean URLs without .php

# Additional rules: Redirect "exam.php" to the clean URL "exam", "finished.php" to "finished", and "home.php" to "home"
RewriteCond %{THE_REQUEST} \s/exam\.php$ [NC]
RewriteRule ^exam\.php$ /exam [R=301,L]    # Redirect exam.php to exam without .php

RewriteCond %{THE_REQUEST} \s/finished\.php$ [NC]
RewriteRule ^finished\.php$ /finished [R=301,L]    # Redirect finished.php to finished without .php

RewriteCond %{THE_REQUEST} \s/home\.php$ [NC]
RewriteRule ^home\.php$ /home [R=301,L]    # Redirect home.php to home without .php

# Optionally, redirect .php URL of access-control.php to clean URL
RewriteCond %{THE_REQUEST} \s/admin/access-control\.php$ [NC]
RewriteRule ^admin/access-control\.php$ /admin/access-control [R=301,L]
